// =============================================
// –î–ê–ù–ù–´–ï –£–ß–ê–°–¢–ù–ò–ö–û–í
// =============================================
const members = [
    {
        id: 1,
        nickname: "–∑–æ—Ä—Ñ",
        username: "@tgzorf",
        category: "–í–ª–∞–¥–µ–ª–µ—Ü",
        role: "–í–ª–∞–¥–µ–ª–µ—Ü",
        description: "–í–ª–∞–¥–µ–ª–µ—Ü –∑–æ—Ä—Ñ Fame. –í—Ö–æ–¥ 50 –∑–≤, –≥–∞–ª–æ—á–∫–∞ 30–∑–≤, –∑–∞–∫—Ä–µ–ø 50–∑–≤.",
        avatar: "img/avatar1.png",
        verified: true,
        pinned: true,
        project: "https://t.me/NOOLSHY",
        telegram: "tgzorf",
        price: "https://noolshy.github.io/market/",
        chat: "https://t.me/NOOLSHY_CHAT",
        market: "https://noolshy.github.io/market/",
        fameList: "https://noolshy.github.io/fame/",
        github: "https://github.com/noolshy",
        // –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö —Å—Å—ã–ª–æ–∫ - –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –∫–∞–∫ —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–∞
        
        joinDate: "2026-01-08",
        activity: "–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è",
        posts: 150,
        followers: 2500,
        priceEntry: "50 –∑–≤",
        priceVerified: "30 –∑–≤",
        pricePinned: "50 –∑–≤",
        details: "–°–æ–∑–¥–∞—Ç–µ–ª—å –∏ –≤–ª–∞–¥–µ–ª–µ—Ü NoolShy Fame. –ó–∞–Ω–∏–º–∞—é—Å—å —Ä–∞–∑–≤–∏—Ç–∏–µ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –∏ –º–æ–¥–µ—Ä–∞—Ü–∏–µ–π. –û—Ç–≤–µ—á–∞—é –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –ø–æ–≤–æ–¥—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —Å–ø–∏—Å–æ–∫ –∏ –¥—Ä—É–≥–∏—Ö —É—Å–ª—É–≥.",
        skills: ["–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ", "–ú–æ–¥–µ—Ä–∞—Ü–∏—è", "–†–∞–∑–≤–∏—Ç–∏–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞"],
        socials: {
            telegram: "@tgzorf",
            project: "https://t.me/NOOLSHY",
            price: "https://noolshy.github.io/market/"
        }
    },
    {
        id: 2,
        nickname: "francisco",
        username: "@pvpfrancisco",
        category: "–ú–µ–¥–∏–π–∫–∞",
        role: "–ú–µ–¥–∏–π–∫–∏",
        description: "–≤ 2018 –≥–æ–¥—É —Å–æ—Å—Ç–æ—è–ª–∞ –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ, –≤ —Å—Ç–∞–∫–µ —É —Ä–µ–π–∑–æ–≤—ã—Ö, –≤ 2024 –≥–æ–¥—É –ø–µ—Ä–µ—à–ª–∞ –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏ —Ç–µ–ª–µ–≥—Ä–∞–º–º–∞, –ø–µ—Ä–≤–æ–π –º–æ–µ–π –ª–∏–∫–æ–π –±—ã–ª–∞ –•–∏—Ç—Ä–æ–≤–∞, –∞ –¥–∞–ª—å—à–µ –Ω–∞—á–∞–ª–∏ –ø–æ—è–≤–ª—è—Ç—å—Å—è –ª–∏—á–Ω–æ—Å—Ç–∏ –∫–∞–∫ –º–∏—Ä–∞ –º–∞–Ω—å—è–∫, –∞–Ω—Ç–∏—Ñ–æ–±–æ–≤–∞ –∏ —Ç–¥, –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –Ω–∞—á–∞–ª–∞ –Ω–∞–±–∏—Ä–∞—Ç—å —Ñ–µ–π–º, —Å–µ–π—á–∞—Å –º–µ–Ω—è —Å—á–∏—Ç–∞—é—Ç —Å—Ä–µ–¥–Ω–∏–º —Ñ–µ–π–º–æ–≤—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º",
        avatar: "img/avatar2.png",
        verified: false,
        pinned: false,
        project: "https://t.me/+LS2wWjAg8dYxOTNi",
        joinDate: "2026-01-08",
        activity: "–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è",
        details: "–ú–µ–¥–∏–π–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –≤ NoolShy Fame.",
        skills: ["–ú–µ–¥–∏–π–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å ‚Äî —ç—Ç–æ —á–µ–ª–æ–≤–µ–∫ –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –±–æ–ª—å—à—É—é —É–∑–Ω–∞–≤–∞–µ–º–æ—Å—Ç—å –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏", "–†–∞–∑–≤–∏—Ç–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏"],
        socials: {
            telegram: "@pvpfrancisco",
            project: "https://t.me/+LS2wWjAg8dYxOTNi",
        }
    },
    {
        id: 3,
        nickname: "francisco –º–ª–∞–¥—à–∏–π",
        username: "@oexwu",
        category: "–ú–µ–¥–∏–π–∫–∞",
        role: "–ú–µ–¥–∏–π–∫–∏",
        description: "–ø—Ä–∏—à–µ–ª –≤ –∫–º 2021 –≥–æ–¥—É —Å–æ—Å—Ç–æ—è–ª –≤ –ö–ª–∞–Ω–µ –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ –æ–±–æ—Ä–æ–Ω—ã –ø–µ—Ä–≤–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –±—ã–ª–∞ –°—É—Ü–∏–¥–∞–ª—å–Ω–∞—è –∫–æ–º–∞ –Ω–∞—á–∞–ª–∏ –ø–æ—è–≤–ª—è—Ç—å—Å—è –ª–∏—á–Ω–æ—Å—Ç–∏ –ö—É—Ä–∏–ª–æ–≤, –õ–∏–Ω–¥–µ—Ä—Å–æ–Ω, –ö–∏–ª–ª–æ–≤ –º–ª–∞–¥—à–∏–π, –ö–∏–ª–ª–µ—Ä–æ–≤, –∏ –Ω–∞—á–∞–ª –Ω–∞–±–∏—Ä–∞—Ç—å –Ω–∞–±–∏—Ä–∞—Ç—å —Ñ–µ–π–º —Å–µ–π—á–∞—Å –º–µ–Ω—è —Å—á–∏—Ç–∞—é –°—Ä–µ–¥–Ω–∏–º –§–µ–π–º–æ–≤—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º",
        avatar: "img/avatar3.png",
        verified: false,
        pinned: false,
        project: "https://t.me/+lxGpVXheDIQ2OTRi",
        telegram: "oexwu",       
        joinDate: "2026-01-08",
        activity: "–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è",
        details: "–ú–µ–¥–∏–π–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –≤ NoolShy Fame.",
        skills: ["–ú–µ–¥–∏–π–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å ‚Äî —ç—Ç–æ —á–µ–ª–æ–≤–µ–∫ –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –±–æ–ª—å—à—É—é —É–∑–Ω–∞–≤–∞–µ–º–æ—Å—Ç—å –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏", "–†–∞–∑–≤–∏—Ç–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏"],
        socials: {
            telegram: "@oexwu",
            project: "https://t.me/+lxGpVXheDIQ2OTRi",
        }
    },
    {
        id: 4,
        nickname: "madonna maniac",
        username: "@madonnamaniac",
        category: "–°—Ä–µ–¥–Ω–∏–π —Ñ–µ–π–º",
        role: "–°—Ä–µ–¥–Ω–∏–π —Ñ–µ–π–º",
        description: "–ü—Ä–∏—à–µ–ª –≤ –∫–æ–º—å—é–Ω–Ω–∏—Ç–∏ –≤ –Ω–∞—á–∞–ª–µ 22 –≥–æ–¥–∞, —Å–æ—Å—Ç–æ—è–ª –≤ –ø—Ä–æ–µ–∫—Ç–µ security team, –ø–µ—Ä–≤–æ–π –ª–∏—á–Ω–æ—Å—Ç—å—é –±—ã–ª–∞ –º–∏–Ω–∏—Å—Ç—Ä–æ–≤, —Ç–∞–∫–∂–µ –≤–∞–ª–∏–¥–Ω—É–ª –∞–º–Ω–µ–∑–∏—é/–∞–ø–∞—Ç–∏—é, –ª–∏—á–Ω–æ—Å—Ç–∏ –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–¥–Ω–∏–º–∞–ª —Ñ–µ–π–º –±—ã–ª–∏ –∫–∞–∫: –∫–∞–Ω—Å–∞–º–æ–ª—å—Å–∫–∏–π, –ø—Å–∏—Ö–æ–º–∏—Ä–æ–≤, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –º–∞—Ä–¥–µ—Ä, –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Å—á–∏—Ç–∞—é—Å—å —Å—Ä–µ–¥–Ω–∏–º —Ñ–µ–π–º–æ–º.",
        avatar: "img/avatar4.png",
        verified: false,
        pinned: false,
        project: "https://t.me/+WY-yRFYVxhJjNTFi",
        joinDate: "2026-01-08",
        activity: "–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è",
        details: "madonna maniac –ª–∏—á–Ω–æ—Å—Ç—å –≤ NoolShy Fame.",
        skills: ["madonna maniac ‚Äî —ç—Ç–æ —á–µ–ª–æ–≤–µ–∫ –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –Ω–µ –±–æ–ª—å—à—É—é —É–∑–Ω–∞–≤–∞–µ–º–æ—Å—Ç—å –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏", "–†–∞–∑–≤–∏—Ç–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏"],
        socials: {
            telegram: "@madonnamaniac",
            project: "https://t.me/+WY-yRFYVxhJjNTFi",
        }
    }
];

// =============================================
// –°–°–´–õ–ö–ò –ù–ê –ë–û–¢–ê –ò –ö–û–ù–°–¢–ê–ù–¢–´
// =============================================
const BOT_LINK = "https://t.me/NoolShyfame_bot";
const MEMBERS_PER_PAGE = 12;

// =============================================
// –ú–ê–°–°–ò–í–´ –í–°–ï–• –§–û–ù–û–í –ò –≠–§–§–ï–ö–¢–û–í
// =============================================
const allBackgrounds = [
    'particles', 'waves', 'pulse', 'hooks', 'circuit',
    'grid', 'dots', 'lines', 'hexagon', 'triangles',
    'squares', 'circles', 'nebula', 'galaxy', 'cosmic',
    'stardust', 'matrix', 'cyberpunk', 'circuit2', 'glitch',
    'rain', 'fire', 'water', 'wind', 'vortex',
    'spiral', 'radar', 'sonar'
];

const allThemes = [
    'dark', 'black', 'red', 'red-black', 'red-gray',
    'purple', 'blue', 'green', 'orange', 'pink'
];

// =============================================
// –¢–ï–ö–£–©–ò–ï –ù–ê–°–¢–†–û–ô–ö–ò
// =============================================
let currentTheme = 'dark';
let currentNeonColor = '#808080';
let currentNeonIntensity = 0.5;
let currentNeonSpeed = 5;
let currentAnimatedBg = 'hooks';
let currentBgSpeed = 10;
let currentBgOpacity = 0.5;
let currentPage = 1;
let currentFilter = 'all';
let currentSearchTerm = '';

// =============================================
// –ü–ï–†–ï–ú–ï–ù–ù–´–ï –î–õ–Ø –£–ü–†–ê–í–õ–ï–ù–ò–Ø –°–û–°–¢–û–Ø–ù–ò–ï–ú
// =============================================
let snowEnabled = true;
let neonFlowEnabled = true;
let isInitialized = false;

// =============================================
// –û–°–ù–û–í–ù–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
// =============================================
document.addEventListener('DOMContentLoaded', function() {
    if (isInitialized) return;
    console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è NoolShy Fame...');
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
    initNavigation();
    initMembers();
    initSnow();
    initSettings();
    initNeonControls();
    initAnimatedBg();
    initModals();
    initDynamicNeon();
    initAllAvatars();
    initPerformanceOptimizations();
    initServiceWorker();
    
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ç–∫–∏ —Ñ–æ–Ω–æ–≤
    generateBgGrid();
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
    loadSavedSettings();
    
    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
    setupEventListeners();
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
    checkForUpdates();
    
    isInitialized = true;
    console.log('‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    setTimeout(showWelcomeMessage, 1000);
});

// =============================================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ù–ê–í–ò–ì–ê–¶–ò–ò
// =============================================
function initNavigation() {
    console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏...');
    
    const menuToggle = document.getElementById('menu-toggle');
    const closeMenu = document.getElementById('close-menu');
    const sideMenu = document.getElementById('side-menu');
    
    if (menuToggle) {
        menuToggle.addEventListener('click', () => {
            sideMenu.classList.add('active');
            playSound('menu-open');
            console.log('üì± –ú–µ–Ω—é –æ—Ç–∫—Ä—ã—Ç–æ');
        });
    }
    
    if (closeMenu) {
        closeMenu.addEventListener('click', () => {
            sideMenu.classList.remove('active');
            playSound('menu-close');
            console.log('üì± –ú–µ–Ω—é –∑–∞–∫—Ä—ã—Ç–æ');
        });
    }
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π
    const navTabs = document.querySelectorAll('.nav-tab');
    const menuItems = document.querySelectorAll('.menu-item');
    const sections = document.querySelectorAll('.section');
    
    function switchSection(sectionId) {
        console.log('üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å–µ–∫—Ü–∏—é:', sectionId);
        
        // –ü–ª–∞–≤–Ω–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —Ç–µ–∫—É—â–µ–π —Å–µ–∫—Ü–∏–∏
        sections.forEach(section => {
            if (section.classList.contains('active-section')) {
                section.style.opacity = '0';
                section.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    section.classList.remove('active-section');
                }, 300);
            }
        });
        
        // –ü–ª–∞–≤–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Å–µ–∫—Ü–∏–∏
        setTimeout(() => {
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active-section');
                setTimeout(() => {
                    targetSection.style.opacity = '1';
                    targetSection.style.transform = 'translateY(0)';
                }, 10);
                
                // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–∞—á–∞–ª—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Å–µ–∫—Ü–∏—é
                localStorage.setItem('fame_active_section', sectionId);
            }
        }, 300);
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
        navTabs.forEach(tab => {
            tab.classList.remove('active');
            if (tab.dataset.section === sectionId) {
                tab.classList.add('active');
            }
        });
        
        menuItems.forEach(item => {
            item.classList.remove('active');
            if (item.dataset.section === sectionId) {
                item.classList.add('active');
            }
        });
    }
    
    navTabs.forEach(tab => {
        if (tab.dataset.section) {
            tab.addEventListener('click', (e) => {
                e.preventDefault();
                switchSection(tab.dataset.section);
            });
        }
    });
    
    menuItems.forEach(item => {
        if (item.dataset.section) {
            item.addEventListener('click', () => {
                switchSection(item.dataset.section);
                if (sideMenu) sideMenu.classList.remove('active');
            });
        }
    });
    
    // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
    const faqBtn = document.getElementById('faq-btn');
    const settingsBtn = document.getElementById('settings-btn');
    const menuSettings = document.getElementById('menu-settings');
    const animatedBgBtn = document.getElementById('animated-bg-btn');
    const menuAnimatedBg = document.getElementById('menu-animated-bg');
    
    if (faqBtn) {
        faqBtn.addEventListener('click', () => {
            switchSection('faq-section');
            playSound('click');
        });
    }
    
    if (settingsBtn) {
        settingsBtn.addEventListener('click', () => {
            openModal('settings-modal');
            playSound('click');
        });
    }
    
    if (menuSettings) {
        menuSettings.addEventListener('click', () => {
            openModal('settings-modal');
            if (sideMenu) sideMenu.classList.remove('active');
            playSound('click');
        });
    }
    
    if (animatedBgBtn) {
        animatedBgBtn.addEventListener('click', () => {
            openModal('animated-bg-modal');
            playSound('click');
        });
    }
    
    if (menuAnimatedBg) {
        menuAnimatedBg.addEventListener('click', () => {
            openModal('animated-bg-modal');
            if (sideMenu) sideMenu.classList.remove('active');
            playSound('click');
        });
    }
    
    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ–∫—Ü–∏–∏
    const savedSection = localStorage.getItem('fame_active_section') || 'main';
    switchSection(savedSection);
    
    console.log('‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
}

// =============================================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –í–°–ï–• –ê–í–ê–¢–ê–†–û–í
// =============================================
function initAllAvatars() {
    console.log('üñºÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤–∞—Ç–∞—Ä–æ–≤...');
    
    // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    members.forEach(member => {
        const img = new Image();
        img.src = member.avatar;
        img.onload = () => {
            console.log(`‚úÖ –ê–≤–∞—Ç–∞—Ä –∑–∞–≥—Ä—É–∂–µ–Ω: ${member.nickname}`);
        };
        img.onerror = () => {
            console.warn(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞: ${member.nickname}`);
        };
    });
    
    loadMembers();
}

// =============================================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –£–ß–ê–°–¢–ù–ò–ö–û–í
// =============================================
function initMembers() {
    console.log('üë• –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤...');
    loadMembers();
    
    const filterBtns = document.querySelectorAll('.filter-btn');
    if (filterBtns.length > 0) {
        filterBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                currentFilter = this.dataset.category;
                currentPage = 1;
                console.log('üîç –§–∏–ª—å—Ç—Ä:', currentFilter);
                filterMembers(currentFilter);
                
                playSound('filter');
            });
        });
    }
    
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        let searchTimeout;
        searchInput.addEventListener('input', function(e) {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                currentSearchTerm = e.target.value.toLowerCase();
                console.log('üîç –ü–æ–∏—Å–∫:', currentSearchTerm);
                searchMembers(currentSearchTerm);
            }, 300);
        });
        
        // –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ø–æ–∏—Å–∫–∞
        const searchBox = searchInput.parentElement;
        const clearBtn = document.createElement('button');
        clearBtn.innerHTML = '<i class="fas fa-times"></i>';
        clearBtn.className = 'search-clear';
        clearBtn.style.display = 'none';
        
        clearBtn.addEventListener('click', () => {
            searchInput.value = '';
            currentSearchTerm = '';
            loadMembers();
            clearBtn.style.display = 'none';
            playSound('clear');
        });
        
        searchBox.appendChild(clearBtn);
        
        searchInput.addEventListener('input', function() {
            clearBtn.style.display = this.value ? 'block' : 'none';
        });
    }
    
    console.log('‚úÖ –£—á–∞—Å—Ç–Ω–∏–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
}

// =============================================
// –ó–ê–ì–†–£–ó–ö–ê –£–ß–ê–°–¢–ù–ò–ö–û–í
// =============================================
function loadMembers() {
    const container = document.getElementById('members-container');
    if (!container) {
        console.error('‚ùå –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return;
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    container.innerHTML = `
        <div class="loading-skeleton" style="grid-column: 1 / -1; height: 200px; border-radius: 15px;"></div>
        <div class="loading-skeleton" style="height: 200px; border-radius: 15px;"></div>
        <div class="loading-skeleton" style="height: 200px; border-radius: 15px;"></div>
        <div class="loading-skeleton" style="height: 200px; border-radius: 15px;"></div>
    `;
    
    setTimeout(() => {
        container.innerHTML = '';
        
        if (members.length === 0) {
            container.innerHTML = `
                <div class="no-members" style="grid-column: 1 / -1; text-align: center; padding: 60px 20px;">
                    <i class="fas fa-users fa-3x" style="color: var(--text-secondary); margin-bottom: 20px;"></i>
                    <h3 style="color: var(--text-color); margin-bottom: 10px;">–ù–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</h3>
                    <p style="color: var(--text-secondary);">–°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø—É—Å—Ç</p>
                </div>
            `;
            console.log('‚ÑπÔ∏è –ù–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è');
            return;
        }
        
        const sortedMembers = [...members].sort((a, b) => {
            if (a.pinned && !b.pinned) return -1;
            if (!a.pinned && b.pinned) return 1;
            if (a.verified && !b.verified) return -1;
            if (!a.verified && b.verified) return 1;
            if (a.followers > b.followers) return -1;
            if (a.followers < b.followers) return 1;
            return a.nickname.localeCompare(b.nickname);
        });
        
        let filteredMembers = sortedMembers;
        if (currentFilter !== 'all') {
            filteredMembers = sortedMembers.filter(m => m.category === currentFilter);
        }
        
        if (currentSearchTerm) {
            filteredMembers = filteredMembers.filter(m => 
                m.nickname.toLowerCase().includes(currentSearchTerm) ||
                m.description.toLowerCase().includes(currentSearchTerm) ||
                m.category.toLowerCase().includes(currentSearchTerm)
            );
        }
        
        // –ü–∞–≥–∏–Ω–∞—Ü–∏—è
        const startIndex = (currentPage - 1) * MEMBERS_PER_PAGE;
        const endIndex = startIndex + MEMBERS_PER_PAGE;
        const paginatedMembers = filteredMembers.slice(startIndex, endIndex);
        
        if (paginatedMembers.length === 0) {
            container.innerHTML = `
                <div class="no-results" style="grid-column: 1 / -1; text-align: center; padding: 60px 20px;">
                    <i class="fas fa-search fa-3x" style="color: var(--text-secondary); margin-bottom: 20px;"></i>
                    <h3 style="color: var(--text-color); margin-bottom: 10px;">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
                    <p style="color: var(--text-secondary);">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä</p>
                </div>
            `;
            return;
        }
        
        paginatedMembers.forEach((member, index) => {
            const card = createMemberCard(member);
            card.style.animationDelay = `${index * 0.1}s`;
            container.appendChild(card);
        });
        
        // –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é
        if (filteredMembers.length > MEMBERS_PER_PAGE) {
            addPagination(filteredMembers.length);
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏
        setTimeout(() => {
            document.querySelectorAll('.member-card').forEach(card => {
                card.addEventListener('click', function() {
                    const memberId = this.dataset.id;
                    console.log('üëÜ –ö–ª–∏–∫ –ø–æ —É—á–∞—Å—Ç–Ω–∏–∫—É:', memberId);
                    showProfile(memberId);
                    playSound('card-click');
                });
            });
        }, 100);
        
        console.log(`‚úÖ –£—á–∞—Å—Ç–Ω–∏–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã: ${paginatedMembers.length} –∏–∑ ${filteredMembers.length}`);
    }, 300);
}

// =============================================
// –°–û–ó–î–ê–ù–ò–ï –ö–ê–†–¢–û–ß–ö–ò –£–ß–ê–°–¢–ù–ò–ö–ê
// =============================================
function createMemberCard(member) {
    const card = document.createElement('div');
    card.className = 'member-card';
    card.dataset.id = member.id;
    card.dataset.category = member.category;
    
    if (member.pinned) card.classList.add('pinned');
    if (member.verified) card.classList.add('verified');
    
    let badges = '';
    if (member.pinned) badges += '<span class="pinned-badge" title="–ó–∞–∫—Ä–µ–ø–ª–µ–Ω">üìç</span> ';
    if (member.verified) badges += '<span class="verified-badge" title="–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω">‚úì</span> ';
    
    // –°–æ–∑–¥–∞–µ–º ID –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞
    const avatarId = `avatar-${member.id}-${Date.now()}`;
    
    card.innerHTML = `
        <div class="member-avatar" data-initial="${member.nickname.charAt(0).toUpperCase()}">
            <img id="${avatarId}" 
                 src="data:image/svg+xml;base64,${btoa(createFallbackAvatar(member.nickname))}" 
                 alt="${member.nickname}"
                 loading="lazy"
                 crossorigin="anonymous">
            <div class="avatar-status ${member.activity === '–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è' ? 'online' : 'offline'}" 
                 title="${member.activity}"></div>
        </div>
        
        <div class="member-info">
            <h3>
                ${member.nickname}
                ${member.verified ? '<span class="verified-icon" title="–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω">‚úì</span>' : ''}
            </h3>
            <div class="member-role">${member.role}</div>
            <p class="member-description">${member.description}</p>
            <div class="member-meta">
                <span class="member-followers" title="–ü–æ–¥–ø–∏—Å—á–∏–∫–∏">
                    <i class="fas fa-users"></i> ${formatNumber(member.followers || 0)}
                </span>
                <span class="member-posts" title="–ü–æ—Å—Ç—ã">
                    <i class="fas fa-comment"></i> ${formatNumber(member.posts || 0)}
                </span>
            </div>
            <div class="member-badges">
                ${badges}
                <span class="category-badge">${member.category}</span>
            </div>
        </div>
        
        <div class="member-overlay">
            <button class="view-profile-btn">
                <i class="fas fa-eye"></i> –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è
            </button>
        </div>
    `;
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–≤–∞—Ç–∞—Ä –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞
    setTimeout(() => {
        const img = card.querySelector(`#${avatarId}`);
        if (img) {
            loadAvatarWithFallback(img, member.avatar, member.nickname);
        }
    }, 50);
    
    // –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
    card.addEventListener('mouseenter', () => {
        card.style.zIndex = '100';
    });
    
    card.addEventListener('mouseleave', () => {
        card.style.zIndex = '1';
    });
    
    return card;
}

// =============================================
// –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –£–ß–ê–°–¢–ù–ò–ö–û–í
// =============================================
function filterMembers(category) {
    const cards = document.querySelectorAll('.member-card');
    console.log(`üîç –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ${category}, –Ω–∞–π–¥–µ–Ω–æ –∫–∞—Ä—Ç–æ—á–µ–∫: ${cards.length}`);
    
    cards.forEach((card, index) => {
        const matchesFilter = category === 'all' || card.dataset.category === category;
        
        if (matchesFilter) {
            card.style.display = 'flex';
            setTimeout(() => {
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, index * 50);
        } else {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            setTimeout(() => {
                card.style.display = 'none';
            }, 300);
        }
    });
    
    // –û–±–Ω–æ–≤–∏—Ç—å —Å—á–µ—Ç—á–∏–∫
    updateMembersCounter();
}

// =============================================
// –ü–û–ò–°–ö –£–ß–ê–°–¢–ù–ò–ö–û–í
// =============================================
function searchMembers(term) {
    const cards = document.querySelectorAll('.member-card');
    const activeFilter = currentFilter || 'all';
    
    let visibleCount = 0;
    
    cards.forEach((card, index) => {
        const nickname = card.querySelector('h3').textContent.toLowerCase();
        const description = card.querySelector('.member-description').textContent.toLowerCase();
        const category = card.dataset.category.toLowerCase();
        
        const matchesSearch = nickname.includes(term) || 
                            description.includes(term) || 
                            category.includes(term);
        const matchesFilter = activeFilter === 'all' || card.dataset.category === activeFilter;
        
        if (matchesSearch && matchesFilter) {
            card.style.display = 'flex';
            setTimeout(() => {
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, index * 50);
            visibleCount++;
        } else {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            setTimeout(() => {
                card.style.display = 'none';
            }, 300);
        }
    });
    
    // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
    const container = document.getElementById('members-container');
    if (visibleCount === 0 && term) {
        const noResults = document.createElement('div');
        noResults.className = 'no-results';
        noResults.innerHTML = `
            <div style="text-align: center; padding: 60px 20px; grid-column: 1 / -1;">
                <i class="fas fa-search fa-3x" style="color: var(--text-secondary); margin-bottom: 20px;"></i>
                <h3 style="color: var(--text-color); margin-bottom: 10px;">–ü–æ –∑–∞–ø—Ä–æ—Å—É "${term}" –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
                <p style="color: var(--text-secondary);">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</p>
                <button class="action-btn" onclick="clearSearch()" style="margin-top: 20px;">
                    <i class="fas fa-times"></i> –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫
                </button>
            </div>
        `;
        container.appendChild(noResults);
    }
    
    updateMembersCounter();
}

// =============================================
// –ü–û–ö–ê–ó–ê–¢–¨ –ü–û–õ–ù–´–ô –ü–†–û–§–ò–õ–¨ –£–ß–ê–°–¢–ù–ò–ö–ê
// =============================================
function showProfile(memberId) {
    const member = members.find(m => m.id == memberId);
    if (!member) {
        console.error('‚ùå –£—á–∞—Å—Ç–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω:', memberId);
        showNotification('–£—á–∞—Å—Ç–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
        return;
    }
    
    const container = document.getElementById('profile-content');
    if (!container) {
        console.error('‚ùå –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–æ—Ñ–∏–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return;
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    container.innerHTML = `
        <div class="loading-skeleton" style="height: 300px; border-radius: 15px; margin-bottom: 20px;"></div>
        <div class="loading-skeleton" style="height: 200px; border-radius: 15px;"></div>
    `;
    
    setTimeout(() => {
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã
        const joinDate = new Date(member.joinDate);
        const formattedDate = joinDate.toLocaleDateString('ru-RU', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –±–µ–π–¥–∂–µ–π
        let badgesHtml = '';
        if (member.verified) badgesHtml += '<span class="badge verified" title="–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç">‚úì –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</span>';
        if (member.pinned) badgesHtml += '<span class="badge pinned" title="–ó–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å">üìå –ó–∞–∫—Ä–µ–ø–ª—ë–Ω</span>';
        badgesHtml += `<span class="badge category" title="–ö–∞—Ç–µ–≥–æ—Ä–∏—è">${member.category}</span>`;
        
        // –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
        let mainButtons = '';
        if (member.telegram) {
            mainButtons += createSocialButton('fab fa-telegram', '–ù–∞–ø–∏—Å–∞—Ç—å –≤ –õ–°', `https://t.me/${member.telegram}`, 'telegram');
        }
        if (member.project) {
            mainButtons += createSocialButton('fas fa-external-link-alt', '–û—Å–Ω–æ–≤–Ω–æ–π –∫–∞–Ω–∞–ª', member.project, 'telegram');
        }
        if (member.chat) {
            mainButtons += createSocialButton('fas fa-comments', '–ß–∞—Ç', member.chat, 'telegram');
        }
        if (member.market) {
            mainButtons += createSocialButton('fas fa-shopping-cart', '–ú–∞—Ä–∫–µ—Ç', member.market);
        }
        if (member.fameList) {
            mainButtons += createSocialButton('fas fa-list', '–§–µ–π–º –ª–∏—Å—Ç', member.fameList);
        }
        if (member.github) {
            mainButtons += createSocialButton('fab fa-github', 'GitHub', member.github);
        }
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
        let extraButtons = '';
        const allPossibleLinks = {
            'price': {icon: 'fas fa-tag', text: '–ü—Ä–∞–π—Å', color: '#ff9900'},
            'priceList': {icon: 'fas fa-tags', text: '–ü—Ä–∞–π—Å-–ª–∏—Å—Ç', color: '#ff6600'},
            'tiktok': {icon: 'fab fa-tiktok', text: 'TikTok', color: '#000000'},
            'youtube': {icon: 'fab fa-youtube', text: 'YouTube', color: '#ff0000'},
            'yt': {icon: 'fab fa-youtube', text: 'YouTube', color: '#ff0000'},
            'discord': {icon: 'fab fa-discord', text: 'Discord', color: '#5865F2'},
            'vk': {icon: 'fab fa-vk', text: 'VK', color: '#4C75A3'},
            'gift': {icon: 'fas fa-gift', text: '–ü–æ–¥–∞—Ä–æ–∫', color: '#ff3366'},
            'website': {icon: 'fas fa-globe', text: '–°–∞–π—Ç', color: '#00aaff'},
            'reputation': {icon: 'fas fa-star', text: '–†–µ–ø—É—Ç–∞—Ü–∏—è', color: '#ffd700'},
            'work': {icon: 'fas fa-briefcase', text: '–í–æ—Ä–∫', color: '#00cc99'},
            'forum': {icon: 'fas fa-users', text: '–§–æ—Ä—É–º', color: '#9966ff'},
            'def': {icon: 'fas fa-shield-alt', text: '–î–µ—Ñ', color: '#33cc33'},
            'whitelist': {icon: 'fas fa-list', text: 'White List', color: '#ffffff'},
            'blog': {icon: 'fas fa-blog', text: '–ë–ª–æ–≥', color: '#ff66cc'},
            'private': {icon: 'fas fa-lock', text: '–ü—Ä–∏–≤–∞—Ç', color: '#333333'}
        };
        
        Object.keys(allPossibleLinks).forEach(key => {
            if (member[key]) {
                extraButtons += createSocialButton(
                    allPossibleLinks[key].icon,
                    allPossibleLinks[key].text,
                    member[key],
                    '',
                    allPossibleLinks[key].color
                );
            }
        });
        
        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        const stats = {
            '–°—Ç–∞—Ç—É—Å': member.role,
            '–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è': member.verified ? '‚úì –ü–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω' : '‚úó –ù–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω',
            '–ó–∞–∫—Ä–µ–ø': member.pinned ? 'üìå –í–∫–ª—é—á—ë–Ω' : '‚úó –í—ã–∫–ª—é—á–µ–Ω',
            '–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏': formattedDate,
            '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å': member.activity,
            '–ü–æ–¥–ø–∏—Å—á–∏–∫–∏': formatNumber(member.followers),
            '–ü–æ—Å—Ç—ã': formatNumber(member.posts),
            'ID': member.id
        };
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Ü–µ–Ω—ã –µ—Å–ª–∏ –µ—Å—Ç—å
        if (member.priceEntry) stats['–¶–µ–Ω–∞ –≤—Ö–æ–¥–∞'] = member.priceEntry;
        if (member.priceVerified) stats['–¶–µ–Ω–∞ –≥–∞–ª–æ—á–∫–∏'] = member.priceVerified;
        if (member.pricePinned) stats['–¶–µ–Ω–∞ –∑–∞–∫—Ä–µ–ø–∞'] = member.pricePinned;
        
        let statsHtml = '';
        Object.entries(stats).forEach(([label, value]) => {
            if (value) {
                statsHtml += `
                    <div class="stat-item">
                        <span class="stat-label">${label}:</span>
                        <span class="stat-value">${value}</span>
                    </div>
                `;
            }
        });
        
        // ID –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è
        const profileAvatarId = `profile-avatar-${member.id}-${Date.now()}`;
        
        container.innerHTML = `
            <div class="profile-header">
                <div class="profile-avatar" data-initial="${member.nickname.charAt(0).toUpperCase()}">
                    <img id="${profileAvatarId}" 
                         src="data:image/svg+xml;base64,${btoa(createFallbackAvatar(member.nickname))}" 
                         alt="${member.nickname}"
                         loading="eager"
                         crossorigin="anonymous">
                    <div class="profile-status ${member.activity === '–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è' ? 'online' : 'offline'}" 
                         title="${member.activity}"></div>
                </div>
                
                <h1 class="profile-title">${member.nickname}</h1>
                <p class="profile-username">${member.username}</p>
                
                <div class="profile-badges">
                    ${badgesHtml}
                </div>
                
                <div class="profile-stats-mini">
                    <div class="stat-mini">
                        <i class="fas fa-users"></i>
                        <span class="stat-value">${formatNumber(member.followers || 0)}</span>
                        <span class="stat-label">–ü–æ–¥–ø–∏—Å—á–∏–∫–∏</span>
                    </div>
                    <div class="stat-mini">
                        <i class="fas fa-comment"></i>
                        <span class="stat-value">${formatNumber(member.posts || 0)}</span>
                        <span class="stat-label">–ü–æ—Å—Ç—ã</span>
                    </div>
                    <div class="stat-mini">
                        <i class="fas fa-calendar"></i>
                        <span class="stat-value">${formattedDate.split(' ')[2]}</span>
                        <span class="stat-label">–ì–æ–¥ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è</span>
                    </div>
                </div>
                
                <div class="profile-actions">
                    ${mainButtons}
                    <button class="action-btn" onclick="copyProfileLink('${member.nickname}')">
                        <i class="fas fa-share"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
                    </button>
                    <button class="action-btn" onclick="switchSection('main')">
                        <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
                    </button>
                </div>
            </div>
            
            <div class="profile-content">
                <div class="profile-description">
                    <h3><i class="fas fa-info-circle"></i> –û–ø–∏—Å–∞–Ω–∏–µ</h3>
                    <p>${member.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
                    
                    ${member.details ? `
                        <h3><i class="fas fa-ellipsis-h"></i> –î–µ—Ç–∞–ª–∏</h3>
                        <p>${member.details}</p>
                    ` : ''}
                    
                    ${member.skills && member.skills.length > 0 ? `
                        <h3><i class="fas fa-star"></i> –ù–∞–≤—ã–∫–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</h3>
                        <div class="skills-list">
                            ${member.skills.map(skill => `<span class="skill-badge">${skill}</span>`).join('')}
                        </div>
                    ` : ''}
                    
                    ${extraButtons ? `
                        <h3><i class="fas fa-link"></i> –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏</h3>
                        <div class="profile-actions">
                            ${extraButtons}
                        </div>
                    ` : ''}
                </div>
                
                <div class="profile-stats">
                    <h3><i class="fas fa-chart-bar"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    ${statsHtml}
                    
                    ${member.priceEntry || member.priceVerified || member.pricePinned ? `
                        <div class="price-info" style="margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                            <h4 style="margin-bottom: 15px; color: var(--primary-color);">
                                <i class="fas fa-tags"></i> –£—Å–ª—É–≥–∏ –∏ —Ü–µ–Ω—ã
                            </h4>
                            ${member.priceEntry ? `<div class="price-item"><span>–í—Ö–æ–¥ –≤ —Ñ–µ–π–º-–ª–∏—Å—Ç:</span> <strong>${member.priceEntry}</strong></div>` : ''}
                            ${member.priceVerified ? `<div class="price-item"><span>–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è:</span> <strong>${member.priceVerified}</strong></div>` : ''}
                            ${member.pricePinned ? `<div class="price-item"><span>–ó–∞–∫—Ä–µ–ø –ø—Ä–æ—Ñ–∏–ª—è:</span> <strong>${member.pricePinned}</strong></div>` : ''}
                        </div>
                    ` : ''}
                </div>
            </div>
        `;
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–≤–∞—Ç–∞—Ä –ø—Ä–æ—Ñ–∏–ª—è
        setTimeout(() => {
            const img = document.getElementById(profileAvatarId);
            if (img) {
                loadAvatarWithFallback(img, member.avatar, member.nickname);
            }
        }, 50);
        
        // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –∫ –ø—Ä–æ—Ñ–∏–ª—é
        setTimeout(() => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }, 100);
        
        switchSection('profile-details');
        playSound('profile-open');
        
        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è
        trackProfileView(memberId);
    }, 300);
}

// =============================================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–ù–ï–ì–ê
// =============================================
function initSnow() {
    const snowContainer = document.querySelector('.snow-container');
    if (!snowContainer) return;
    
    createSnowflakes();
    
    const snowToggle = document.getElementById('snow-effect');
    if (snowToggle) {
        snowToggle.addEventListener('change', function() {
            snowEnabled = this.checked;
            if (snowEnabled) {
                snowContainer.style.display = 'block';
                createSnowflakes();
                playSound('snow-on');
            } else {
                snowContainer.style.display = 'none';
                snowContainer.innerHTML = '';
                playSound('snow-off');
            }
            localStorage.setItem('fame_snow', snowEnabled ? 'enabled' : 'disabled');
        });
    }
}

// =============================================
// –°–û–ó–î–ê–ù–ò–ï –°–ù–ï–ñ–ò–ù–û–ö
// =============================================
function createSnowflakes() {
    const snowContainer = document.querySelector('.snow-container');
    if (!snowContainer) return;
    
    snowContainer.innerHTML = '';
    
    // –°–æ–∑–¥–∞–µ–º —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —Å–Ω–µ–∂–∏–Ω–æ–∫
    const snowflakeTypes = [
        {class: 'snowflake-circle', shape: 'circle'},
        {class: 'snowflake-star', shape: 'star'},
        {class: 'snowflake-hexagon', shape: 'hexagon'}
    ];
    
    for (let i = 0; i < 80; i++) {
        const type = snowflakeTypes[Math.floor(Math.random() * snowflakeTypes.length)];
        const snowflake = document.createElement('div');
        snowflake.className = `snowflake ${type.class}`;
        
        const size = Math.random() * 6 + 2;
        const startX = Math.random() * 100;
        const duration = Math.random() * 8 + 3;
        const opacity = Math.random() * 0.6 + 0.2;
        const rotation = Math.random() * 360;
        const delay = Math.random() * 5;
        
        snowflake.style.width = `${size}px`;
        snowflake.style.height = `${size}px`;
        snowflake.style.left = `${startX}vw`;
        snowflake.style.opacity = opacity;
        snowflake.style.animationDuration = `${duration}s`;
        snowflake.style.animationDelay = `${delay}s`;
        snowflake.style.transform = `rotate(${rotation}deg)`;
        
        // –†–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞ —Å–Ω–µ–∂–∏–Ω–æ–∫
        const colors = [
            'rgba(255, 255, 255, 0.9)',
            'rgba(200, 220, 255, 0.8)',
            'rgba(230, 240, 255, 0.7)'
        ];
        snowflake.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–Ω—å –¥–ª—è –æ–±—ä–µ–º–∞
        snowflake.style.boxShadow = `0 0 ${size}px rgba(255, 255, 255, 0.5)`;
        
        snowContainer.appendChild(snowflake);
    }
    
    console.log('‚ùÑÔ∏è –°–æ–∑–¥–∞–Ω–æ —Å–Ω–µ–∂–∏–Ω–æ–∫: 80');
}

// =============================================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ù–ê–°–¢–†–û–ï–ö
// =============================================
function initSettings() {
    console.log('‚öôÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫...');
    
    const settingsTabs = document.querySelectorAll('.settings-tab');
    const tabContents = document.querySelectorAll('.tab-content');
    
    settingsTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const tabId = this.dataset.tab + '-tab';
            
            settingsTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            
            tabContents.forEach(content => {
                content.classList.remove('active');
                if (content.id === tabId) {
                    content.classList.add('active');
                    playSound('tab-switch');
                }
            });
        });
    });
    
    const themeOptions = document.querySelectorAll('.theme-option');
    
    themeOptions.forEach(option => {
        option.addEventListener('click', function() {
            const theme = this.dataset.theme;
            
            themeOptions.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');
            
            applyTheme(theme);
            playSound('theme-change');
        });
    });
    
    const bgUpload = document.getElementById('bg-upload');
    const bgPreview = document.getElementById('bg-preview');
    
    if (bgUpload && bgPreview) {
        bgUpload.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    showNotification('–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å. 5MB)', 'error');
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø —Ñ–∞–π–ª–∞
                if (!file.type.match('image.*')) {
                    showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ', 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    bgPreview.innerHTML = `
                        <img src="${e.target.result}" alt="–§–æ–Ω" style="width:100%;height:200px;object-fit:cover;border-radius:10px;">
                        <button class="remove-bg-btn" onclick="removeCustomBackground()" title="–£–¥–∞–ª–∏—Ç—å —Ñ–æ–Ω">
                            <i class="fas fa-times"></i>
                        </button>
                    `;
                    bgPreview.style.display = 'block';
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                    localStorage.setItem('fame_background', e.target.result);
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ–Ω
                    document.body.style.backgroundImage = `url(${e.target.result})`;
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundAttachment = 'fixed';
                    document.body.style.backgroundPosition = 'center';
                    
                    showNotification('–§–æ–Ω —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω', 'success');
                    playSound('upload-success');
                };
                
                reader.onerror = function() {
                    showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞', 'error');
                    playSound('upload-error');
                };
                
                reader.readAsDataURL(file);
            }
        });
    }
    
    const neonFlowEffect = document.getElementById('neon-flow-effect');
    if (neonFlowEffect) {
        neonFlowEffect.addEventListener('change', function() {
            neonFlowEnabled = this.checked;
            if (neonFlowEnabled) {
                initDynamicNeon();
                playSound('neon-on');
            } else {
                removeNeonFlow();
                playSound('neon-off');
            }
            localStorage.setItem('fame_neon_flow', neonFlowEnabled ? 'enabled' : 'disabled');
        });
    }
    
    console.log('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
}

// =============================================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ö–û–ù–¢–†–û–õ–û–í –ù–ï–û–ù–ê
// =============================================
function initNeonControls() {
    console.log('üåà –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ –Ω–µ–æ–Ω–∞...');
    
    const neonColor = document.getElementById('neon-color');
    const neonIntensity = document.getElementById('neon-intensity');
    const neonSpeed = document.getElementById('neon-speed');
    const applyNeonBtn = document.getElementById('apply-neon');
    const intensityValue = document.getElementById('intensity-value');
    const speedValue = document.getElementById('speed-value');
    const colorPreview = document.getElementById('neon-color-preview');
    
    if (neonColor && colorPreview) {
        neonColor.addEventListener('input', function() {
            colorPreview.style.backgroundColor = this.value;
            colorPreview.style.boxShadow = `0 0 20px ${this.value}`;
        });
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        colorPreview.style.backgroundColor = neonColor.value;
        colorPreview.style.boxShadow = `0 0 20px ${neonColor.value}`;
    }
    
    if (neonIntensity && intensityValue) {
        neonIntensity.addEventListener('input', function() {
            const value = parseInt(this.value);
            intensityValue.textContent = value + '%';
            intensityValue.style.color = `hsl(${value}, 100%, 60%)`;
        });
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        const initialIntensity = parseInt(neonIntensity.value);
        intensityValue.textContent = initialIntensity + '%';
        intensityValue.style.color = `hsl(${initialIntensity}, 100%, 60%)`;
    }
    
    if (neonSpeed && speedValue) {
        const speedLabels = {
            1: 'üü¢ –û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ',
            2: 'üü° –ú–µ–¥–ª–µ–Ω–Ω–æ',
            3: 'üü° –ù–µ–º–Ω–æ–≥–æ –º–µ–¥–ª–µ–Ω–Ω–æ',
            4: 'üü† –ù–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–π',
            5: 'üü† –°—Ä–µ–¥–Ω—è—è',
            6: 'üü† –í—ã—à–µ —Å—Ä–µ–¥–Ω–µ–π',
            7: 'üî¥ –ë—ã—Å—Ç—Ä–æ',
            8: 'üî¥ –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ',
            9: 'üî¥ –°—É–ø–µ—Ä –±—ã—Å—Ç—Ä–æ',
            10: '‚ö° –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è'
        };
        
        neonSpeed.addEventListener('input', function() {
            const value = parseInt(this.value);
            speedValue.textContent = speedLabels[value] || '–°—Ä–µ–¥–Ω—è—è';
            speedValue.style.color = value <= 3 ? '#00ff00' : 
                                   value <= 5 ? '#ffff00' : 
                                   value <= 7 ? '#ff9900' : '#ff0000';
        });
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        const initialSpeed = parseInt(neonSpeed.value);
        speedValue.textContent = speedLabels[initialSpeed] || '–°—Ä–µ–¥–Ω—è—è';
        speedValue.style.color = initialSpeed <= 3 ? '#00ff00' : 
                               initialSpeed <= 5 ? '#ffff00' : 
                               initialSpeed <= 7 ? '#ff9900' : '#ff0000';
    }
    
    if (applyNeonBtn) {
        applyNeonBtn.addEventListener('click', function() {
            const color = neonColor.value;
            const intensity = parseInt(neonIntensity.value) / 100;
            const speed = parseInt(neonSpeed.value);
            
            applyNeonSettings(color, intensity, speed);
            playSound('neon-apply');
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ–æ–Ω–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã', 'success');
        });
    }
    
    console.log('‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—ã –Ω–µ–æ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
}

// =============================================
// –ü–†–ò–ú–ï–ù–ï–ù–ò–ï –ù–ê–°–¢–†–û–ï–ö –ù–ï–û–ù–ê
// =============================================
function applyNeonSettings(color, intensity, speed) {
    console.log(`üé® –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–µ–æ–Ω–∞: —Ü–≤–µ—Ç=${color}, –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å=${intensity}, —Å–∫–æ—Ä–æ—Å—Ç—å=${speed}`);
    
    currentNeonColor = color;
    currentNeonIntensity = intensity;
    currentNeonSpeed = speed;
    
    localStorage.setItem('fame_neon_color', color);
    localStorage.setItem('fame_neon_intensity', intensity);
    localStorage.setItem('fame_neon_speed', speed);
    
    initDynamicNeon();
}

// =============================================
// –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò–ô –ù–ï–û–ù
// =============================================
function initDynamicNeon() {
    const oldStyle = document.getElementById('dynamic-neon-style');
    if (oldStyle) oldStyle.remove();
    
    const hex = currentNeonColor;
    const r = parseInt(hex.slice(1,3), 16);
    const g = parseInt(hex.slice(3,5), 16);
    const b = parseInt(hex.slice(5,7), 16);
    
    const duration = (11 - currentNeonSpeed) + 's';
    const glowSize1 = 10 * currentNeonIntensity;
    const glowSize2 = 20 * currentNeonIntensity;
    const glowSize3 = 30 * currentNeonIntensity;
    const glowOpacity1 = 0.8 * currentNeonIntensity;
    const glowOpacity2 = 0.6 * currentNeonIntensity;
    const glowOpacity3 = 0.4 * currentNeonIntensity;
    
    const style = document.createElement('style');
    style.id = 'dynamic-neon-style';
    
    style.textContent = `
        @keyframes neonFlow {
            0%, 100% { 
                box-shadow: 0 0 ${glowSize1}px rgba(${r}, ${g}, ${b}, ${glowOpacity1}),
                          0 0 ${glowSize2}px rgba(${r}, ${g}, ${b}, ${glowOpacity2}),
                          0 0 ${glowSize3}px rgba(${r}, ${g}, ${b}, ${glowOpacity3}),
                          inset 0 0 ${glowSize1}px rgba(${r}, ${g}, ${b}, ${glowOpacity1 * 0.6}); 
                border-color: rgba(${r}, ${g}, ${b}, ${glowOpacity1});
            }
            50% { 
                box-shadow: 0 0 ${glowSize1 * 1.5}px rgba(${r}, ${g}, ${b}, ${glowOpacity1 * 1.1}),
                          0 0 ${glowSize2 * 1.25}px rgba(${r}, ${g}, ${b}, ${glowOpacity2 * 1.1}),
                          0 0 ${glowSize3 * 1.15}px rgba(${r}, ${g}, ${b}, ${glowOpacity3 * 1.1}),
                          inset 0 0 ${glowSize1 * 1.5}px rgba(${r}, ${g}, ${b}, ${glowOpacity1 * 0.8}); 
                border-color: rgba(${r}, ${g}, ${b}, ${glowOpacity1 * 1.2});
            }
        }
        
        @keyframes textNeonFlow {
            0%, 100% { 
                text-shadow: 0 0 ${5 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.8 * currentNeonIntensity}),
                           0 0 ${10 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.6 * currentNeonIntensity}),
                           0 0 ${15 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.4 * currentNeonIntensity}); 
            }
            50% { 
                text-shadow: 0 0 ${8 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.9 * currentNeonIntensity}),
                           0 0 ${15 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.7 * currentNeonIntensity}),
                           0 0 ${22 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.5 * currentNeonIntensity}); 
            }
        }
        
        .neon-flow {
            animation: neonFlow ${duration} ease-in-out infinite !important;
        }
        
        .text-neon-flow {
            animation: textNeonFlow ${duration} ease-in-out infinite !important;
        }
        
        .neon-border {
            position: relative;
        }
        
        .neon-border::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, 
                rgba(${r}, ${g}, ${b}, ${currentNeonIntensity * 0.8}),
                rgba(${r}, ${g}, ${b}, ${currentNeonIntensity * 0.4}),
                rgba(${r}, ${g}, ${b}, ${currentNeonIntensity * 0.8})
            );
            border-radius: inherit;
            z-index: -1;
            opacity: ${currentNeonIntensity * 0.5};
            animation: neonFlow ${duration} ease-in-out infinite;
        }
    `;
    
    document.head.appendChild(style);
    
    if (neonFlowEnabled) {
        applyNeonToElements();
    }
    
    console.log('üåà –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –Ω–µ–æ–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
}

// =============================================
// –ü–†–ò–ú–ï–ù–ï–ù–ò–ï –ù–ï–û–ù–ê –ö –≠–õ–ï–ú–ï–ù–¢–ê–ú
// =============================================
function applyNeonToElements() {
    document.querySelectorAll('.member-card').forEach(card => {
        card.classList.add('neon-flow');
    });
    
    document.querySelectorAll('.modal-content').forEach(modal => {
        modal.classList.add('neon-flow');
    });
    
    document.querySelectorAll('.upload-btn').forEach(btn => {
        btn.classList.add('neon-flow');
    });
    
    document.querySelectorAll('.action-btn').forEach(btn => {
        btn.classList.add('neon-border');
    });
    
    const profileHeader = document.querySelector('.profile-header');
    if (profileHeader) {
        profileHeader.classList.add('neon-flow');
    }
    
    console.log('‚ú® –ù–µ–æ–Ω –ø—Ä–∏–º–µ–Ω–µ–Ω –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º');
}

// =============================================
// –£–î–ê–õ–ï–ù–ò–ï –≠–§–§–ï–ö–¢–ê –ü–ï–†–ï–õ–ò–í–ê–ù–ò–Ø
// =============================================
function removeNeonFlow() {
    document.querySelectorAll('.neon-flow').forEach(el => {
        el.classList.remove('neon-flow');
    });
    document.querySelectorAll('.text-neon-flow').forEach(el => {
        el.classList.remove('text-neon-flow');
    });
    document.querySelectorAll('.neon-border').forEach(el => {
        el.classList.remove('neon-border');
    });
    
    console.log('‚ú® –≠—Ñ—Ñ–µ–∫—Ç –Ω–µ–æ–Ω–∞ –æ—Ç–∫–ª—é—á–µ–Ω');
}

// =============================================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ê–ù–ò–ú–ò–†–û–í–ê–ù–ù–û–ì–û –§–û–ù–ê
// =============================================
function initAnimatedBg() {
    console.log('üé¨ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–æ–Ω–∞...');
    
    const bgSpeed = document.getElementById('bg-speed');
    const bgOpacity = document.getElementById('bg-opacity');
    const applyBgBtn = document.getElementById('apply-animated-bg');
    
    if (bgSpeed) {
        bgSpeed.addEventListener('input', function() {
            currentBgSpeed = parseInt(this.value);
            const speedLabels = {
                1: '–û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ', 5: '–ú–µ–¥–ª–µ–Ω–Ω–æ', 10: '–°—Ä–µ–¥–Ω–µ',
                15: '–ë—ã—Å—Ç—Ä–æ', 20: '–û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ'
            };
            console.log(`üé¨ –°–∫–æ—Ä–æ—Å—Ç—å —Ñ–æ–Ω–∞: ${currentBgSpeed} (${speedLabels[currentBgSpeed] || '–°—Ä–µ–¥–Ω–µ'})`);
        });
    }
    
    if (bgOpacity) {
        bgOpacity.addEventListener('input', function() {
            currentBgOpacity = parseInt(this.value) / 100;
            console.log(`üé¨ –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Ñ–æ–Ω–∞: ${currentBgOpacity}`);
        });
    }
    
    if (applyBgBtn) {
        applyBgBtn.addEventListener('click', function() {
            applyAnimatedBg();
            playSound('bg-apply');
            showNotification('–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω –ø—Ä–∏–º–µ–Ω–µ–Ω', 'success');
        });
    }
    
    console.log('‚úÖ –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
}

// =============================================
// –ì–ï–ù–ï–†–ê–¶–ò–Ø –°–ï–¢–ö–ò –§–û–ù–û–í
// =============================================
function generateBgGrid() {
    const grid = document.querySelector('.animated-bg-grid');
    if (!grid) {
        console.log('‚ùå –°–µ—Ç–∫–∞ —Ñ–æ–Ω–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
        return;
    }
    
    grid.innerHTML = '';
    
    allBackgrounds.forEach((bg, index) => {
        const option = document.createElement('div');
        option.className = `animated-bg-option ${bg === currentAnimatedBg ? 'active' : ''}`;
        option.dataset.bg = bg;
        option.style.animationDelay = `${index * 0.05}s`;
        
        option.innerHTML = `
            <div class="bg-preview ${bg}-bg"></div>
            <span>${getBgName(bg)}</span>
            ${bg === currentAnimatedBg ? '<div class="bg-selected"><i class="fas fa-check"></i></div>' : ''}
        `;
        
        option.addEventListener('click', function() {
            document.querySelectorAll('.animated-bg-option').forEach(opt => {
                opt.classList.remove('active');
                opt.querySelector('.bg-selected')?.remove();
            });
            this.classList.add('active');
            currentAnimatedBg = this.dataset.bg;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤—ã–±–æ—Ä–∞
            if (!this.querySelector('.bg-selected')) {
                const selected = document.createElement('div');
                selected.className = 'bg-selected';
                selected.innerHTML = '<i class="fas fa-check"></i>';
                this.appendChild(selected);
            }
            
            console.log('üé® –í—ã–±—Ä–∞–Ω —Ñ–æ–Ω:', currentAnimatedBg);
            playSound('bg-select');
        });
        
        grid.appendChild(option);
    });
    console.log(`‚úÖ –°–µ—Ç–∫–∞ —Ñ–æ–Ω–æ–≤ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: ${allBackgrounds.length} –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤`);
}

// =============================================
// –ü–†–ò–ú–ï–ù–ï–ù–ò–ï –ê–ù–ò–ú–ò–†–û–í–ê–ù–ù–û–ì–û –§–û–ù–ê
// =============================================
function applyAnimatedBg() {
    const bgElement = document.getElementById('animated-bg');
    if (!bgElement) return;
    
    // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã —Ñ–æ–Ω–æ–≤
    allBackgrounds.forEach(bg => {
        bgElement.classList.remove(`${bg}-bg`);
    });
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ–æ–Ω
    bgElement.classList.add(`${currentAnimatedBg}-bg`);
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏
    const speed = currentBgSpeed / 10;
    bgElement.style.animationDuration = `${20 / speed}s`;
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å
    bgElement.style.opacity = currentBgOpacity;
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    localStorage.setItem('fame_animated_bg', currentAnimatedBg);
    localStorage.setItem('fame_bg_speed', currentBgSpeed);
    localStorage.setItem('fame_bg_opacity', currentBgOpacity);
    
    console.log(`‚úÖ –§–æ–Ω –ø—Ä–∏–º–µ–Ω–µ–Ω: ${currentAnimatedBg}, —Å–∫–æ—Ä–æ—Å—Ç—å: ${currentBgSpeed}, –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å: ${currentBgOpacity}`);
}

// =============================================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ú–û–î–ê–õ–¨–ù–´–• –û–ö–û–ù
// =============================================
function initModals() {
    console.log('üì¶ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω...');
    
    document.querySelectorAll('.close-modal').forEach(btn => {
        btn.addEventListener('click', function() {
            closeModal(this.closest('.modal'));
            playSound('modal-close');
        });
    });
    
    window.addEventListener('click', function(event) {
        if (event.target.classList.contains('modal')) {
            closeModal(event.target);
        }
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∞–≤–∏—à–µ Esc
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closeAllModals();
        }
    });
    
    console.log('‚úÖ –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
}

// =============================================
// –û–¢–ö–†–´–¢–ò–ï –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê
// =============================================
function openModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø–æ—è–≤–ª–µ–Ω–∏—è
        const modalContent = modal.querySelector('.modal-content');
        if (modalContent) {
            modalContent.style.transform = 'scale(0.9)';
            modalContent.style.opacity = '0';
            setTimeout(() => {
                modalContent.style.transform = 'scale(1)';
                modalContent.style.opacity = '1';
            }, 10);
        }
        
        console.log(`üìÇ –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ: ${modalId}`);
        playSound('modal-open');
    } else {
        console.error(`‚ùå –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ: ${modalId}`);
    }
}

// =============================================
// –ó–ê–ö–†–´–¢–ò–ï –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê
// =============================================
function closeModal(modal) {
    if (modal) {
        const modalContent = modal.querySelector('.modal-content');
        if (modalContent) {
            modalContent.style.transform = 'scale(0.9)';
            modalContent.style.opacity = '0';
        }
        
        setTimeout(() => {
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }, 300);
        
        console.log('üìÇ –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–∫—Ä—ã—Ç–æ');
    }
}

// =============================================
// –ó–ê–ö–†–´–¢–ò–ï –í–°–ï–• –ú–û–î–ê–õ–¨–ù–´–• –û–ö–û–ù
// =============================================
function closeAllModals() {
    document.querySelectorAll('.modal.active').forEach(modal => {
        closeModal(modal);
    });
}

// =============================================
// –ó–ê–ì–†–£–ó–ö–ê –°–û–•–†–ê–ù–ï–ù–ù–´–• –ù–ê–°–¢–†–û–ï–ö
// =============================================
function loadSavedSettings() {
    console.log('üíæ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫...');
    
    // –¢–µ–º–∞
    const savedTheme = localStorage.getItem('fame_theme') || 'dark';
    const themeOption = document.querySelector(`.theme-option[data-theme="${savedTheme}"]`);
    if (themeOption) {
        themeOption.classList.add('active');
        applyTheme(savedTheme);
    }
    
    // –§–æ–Ω
    const savedBg = localStorage.getItem('fame_background');
    if (savedBg) {
        const bgPreview = document.getElementById('bg-preview');
        if (bgPreview) {
            bgPreview.innerHTML = `
                <img src="${savedBg}" alt="–§–æ–Ω" style="width:100%;height:200px;object-fit:cover;border-radius:10px;">
                <button class="remove-bg-btn" onclick="removeCustomBackground()" title="–£–¥–∞–ª–∏—Ç—å —Ñ–æ–Ω">
                    <i class="fas fa-times"></i>
                </button>
            `;
            bgPreview.style.display = 'block';
        }
        
        document.body.style.backgroundImage = `url(${savedBg})`;
        document.body.style.backgroundSize = 'cover';
        document.body.style.backgroundAttachment = 'fixed';
        document.body.style.backgroundPosition = 'center';
    }
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ–æ–Ω–∞
    const savedNeonColor = localStorage.getItem('fame_neon_color') || '#808080';
    const savedNeonIntensity = parseFloat(localStorage.getItem('fame_neon_intensity')) || 0.5;
    const savedNeonSpeed = parseInt(localStorage.getItem('fame_neon_speed')) || 5;
    
    const neonColor = document.getElementById('neon-color');
    const neonIntensity = document.getElementById('neon-intensity');
    const neonSpeed = document.getElementById('neon-speed');
    
    if (neonColor) neonColor.value = savedNeonColor;
    if (neonIntensity) neonIntensity.value = savedNeonIntensity * 100;
    if (neonSpeed) neonSpeed.value = savedNeonSpeed;
    
    applyNeonSettings(savedNeonColor, savedNeonIntensity, savedNeonSpeed);
    
    // –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω
    const savedAnimatedBg = localStorage.getItem('fame_animated_bg') || 'hooks';
    const savedBgSpeed = parseInt(localStorage.getItem('fame_bg_speed')) || 10;
    const savedBgOpacity = parseFloat(localStorage.getItem('fame_bg_opacity')) || 0.5;
    
    currentAnimatedBg = savedAnimatedBg;
    currentBgSpeed = savedBgSpeed;
    currentBgOpacity = savedBgOpacity;
    
    const bgSpeed = document.getElementById('bg-speed');
    const bgOpacity = document.getElementById('bg-opacity');
    
    if (bgSpeed) bgSpeed.value = savedBgSpeed;
    if (bgOpacity) bgOpacity.value = savedBgOpacity * 100;
    
    applyAnimatedBg();
    
    // –≠—Ñ—Ñ–µ–∫—Ç –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è
    const savedNeonFlow = localStorage.getItem('fame_neon_flow');
    const neonFlowCheckbox = document.getElementById('neon-flow-effect');
    if (neonFlowCheckbox) {
        if (savedNeonFlow === 'disabled') {
            neonFlowCheckbox.checked = false;
            neonFlowEnabled = false;
            removeNeonFlow();
        } else {
            neonFlowCheckbox.checked = true;
            neonFlowEnabled = true;
        }
    }
    
    // –°–Ω–µ–≥
    const savedSnow = localStorage.getItem('fame_snow');
    const snowCheckbox = document.getElementById('snow-effect');
    if (snowCheckbox) {
        if (savedSnow === 'disabled') {
            snowCheckbox.checked = false;
            snowEnabled = false;
            const snowContainer = document.querySelector('.snow-container');
            if (snowContainer) snowContainer.style.display = 'none';
        } else {
            snowCheckbox.checked = true;
            snowEnabled = true;
        }
    }
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
    const savedSort = localStorage.getItem('fame_sort_by') || 'default';
    if (savedSort !== 'default') {
        applySort(savedSort);
    }
    
    console.log('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
}

// =============================================
// –ü–†–ò–ú–ï–ù–ï–ù–ò–ï –¢–ï–ú–´
// =============================================
function applyTheme(theme) {
    console.log(`üé® –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã: ${theme}`);
    
    currentTheme = theme;
    
    const themeClasses = allThemes.map(t => `${t}-theme`);
    document.body.classList.remove(...themeClasses);
    document.body.classList.add(theme + '-theme');
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    updateThemeVariables(theme);
    
    localStorage.setItem('fame_theme', theme);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–º—ã
    updateThemePreview();
}

// =============================================
// –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–†–ï–î–ü–†–û–°–ú–û–¢–†–ê –¢–ï–ú–´
// =============================================
function updateThemePreview() {
    const themeOptions = document.querySelectorAll('.theme-option');
    themeOptions.forEach(option => {
        const theme = option.dataset.theme;
        const preview = option.querySelector('.theme-preview');
        if (preview) {
            preview.className = `theme-preview ${theme}-theme`;
        }
    });
}

// =============================================
// –ì–õ–û–ë–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
// =============================================
window.copyProfileLink = function(username) {
    const link = `${window.location.origin}${window.location.pathname}#profile?user=${encodeURIComponent(username)}`;
    navigator.clipboard.writeText(link).then(() => {
        showNotification('–°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
        playSound('copy-success');
    }).catch(err => {
        console.error('‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:', err);
        showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É', 'error');
    });
};

window.clearSearch = function() {
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        searchInput.value = '';
        currentSearchTerm = '';
        loadMembers();
        
        const clearBtn = searchInput.parentElement.querySelector('.search-clear');
        if (clearBtn) {
            clearBtn.style.display = 'none';
        }
    }
};

window.removeCustomBackground = function() {
    localStorage.removeItem('fame_background');
    document.body.style.backgroundImage = '';
    
    const bgPreview = document.getElementById('bg-preview');
    if (bgPreview) {
        bgPreview.innerHTML = '';
        bgPreview.style.display = 'none';
    }
    
    showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ–æ–Ω —É–¥–∞–ª–µ–Ω', 'info');
    playSound('remove-bg');
};

// =============================================
// –£–¢–ò–õ–ò–¢–´ –ò –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
// =============================================

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
function loadAvatarWithFallback(imgElement, src, nickname) {
    return new Promise((resolve) => {
        const img = new Image();
        
        img.onload = () => {
            imgElement.src = src;
            imgElement.style.opacity = '1';
            imgElement.classList.remove('avatar-fallback');
            resolve(true);
        };
        
        img.onerror = () => {
            // –°–æ–∑–¥–∞–µ–º SVG –∞–≤–∞—Ç–∞—Ä —Å –ø–µ—Ä–≤–æ–π –±—É–∫–≤–æ–π –Ω–∏–∫–∞
            imgElement.src = 'data:image/svg+xml;base64,' + btoa(createFallbackAvatar(nickname));
            imgElement.style.opacity = '1';
            imgElement.classList.add('avatar-fallback');
            resolve(false);
        };
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
        imgElement.style.opacity = '0';
        const parent = imgElement.parentElement;
        if (parent) {
            parent.classList.add('loading');
        }
        
        // –¢–∞–π–º–∞—É—Ç –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏
        setTimeout(() => img.src = src, 100);
        
        // –£–±–∏—Ä–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            if (parent) {
                parent.classList.remove('loading');
            }
            imgElement.style.opacity = '1';
        }, 3000);
    });
}

// –°–æ–∑–¥–∞–Ω–∏–µ fallback –∞–≤–∞—Ç–∞—Ä–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ SVG
function createFallbackAvatar(nickname) {
    const initial = nickname.charAt(0).toUpperCase();
    const color = generateColorFromNickname(nickname);
    
    return `
        <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100">
            <defs>
                <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" stop-color="${color}" />
                    <stop offset="100%" stop-color="${adjustColor(color, -20)}" />
                </linearGradient>
            </defs>
            <rect width="100" height="100" fill="url(#gradient)" rx="50"/>
            <text x="50" y="50" text-anchor="middle" dy="0.35em" 
                  font-family="Arial, sans-serif" font-size="40" 
                  font-weight="bold" fill="#fff" opacity="0.9">${initial}</text>
        </svg>
    `;
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ü–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∏–∫–∞
function generateColorFromNickname(nickname) {
    const colors = [
        '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7',
        '#DDA0DD', '#98D8C8', '#F7DC6F', '#BB8FCE', '#85C1E9',
        '#F8C471', '#82E0AA', '#F1948A', '#85C1E9', '#D7BDE2'
    ];
    
    let hash = 0;
    for (let i = 0; i < nickname.length; i++) {
        hash = nickname.charCodeAt(i) + ((hash << 5) - hash);
    }
    
    return colors[Math.abs(hash) % colors.length];
}

// –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ü–≤–µ—Ç–∞
function adjustColor(color, amount) {
    let usePound = false;
    
    if (color[0] === "#") {
        color = color.slice(1);
        usePound = true;
    }
    
    const num = parseInt(color, 16);
    let r = (num >> 16) + amount;
    let g = ((num >> 8) & 0x00FF) + amount;
    let b = (num & 0x0000FF) + amount;
    
    r = Math.min(Math.max(0, r), 255);
    g = Math.min(Math.max(0, g), 255);
    b = Math.min(Math.max(0, b), 255);
    
    return (usePound ? "#" : "") + (b | (g << 8) | (r << 16)).toString(16).padStart(6, '0');
}

// –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª
function formatNumber(num) {
    if (num >= 1000000) {
        return (num / 1000000).toFixed(1).replace(/\.0$/, '') + 'M';
    }
    if (num >= 1000) {
        return (num / 1000).toFixed(1).replace(/\.0$/, '') + 'k';
    }
    return num.toString();
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∏—Ç–∞–µ–º–æ–≥–æ –∏–º–µ–Ω–∏ —Ñ–æ–Ω–∞
function getBgName(bg) {
    const names = {
        'particles': '–ß–∞—Å—Ç–∏—Ü—ã', 'waves': '–í–æ–ª–Ω—ã', 'pulse': '–ü—É–ª—å—Å–∞—Ü–∏—è',
        'hooks': '–ó–∞—Ü–µ–ø–∫–∏', 'circuit': '–ú–∏–∫—Ä–æ—Å—Ö–µ–º—ã', 'grid': '–°–µ—Ç–∫–∞',
        'dots': '–¢–æ—á–∫–∏', 'lines': '–õ–∏–Ω–∏–∏', 'hexagon': '–®–µ—Å—Ç–∏—É–≥–æ–ª—å–Ω–∏–∫–∏',
        'triangles': '–¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏', 'squares': '–ö–≤–∞–¥—Ä–∞—Ç—ã', 'circles': '–ö—Ä—É–≥–∏',
        'nebula': '–¢—É–º–∞–Ω–Ω–æ—Å—Ç—å', 'galaxy': '–ì–∞–ª–∞–∫—Ç–∏–∫–∞', 'cosmic': '–ö–æ—Å–º–æ—Å',
        'stardust': '–ó–≤—ë–∑–¥–Ω–∞—è –ø—ã–ª—å', 'matrix': '–ú–∞—Ç—Ä–∏—Ü–∞', 'cyberpunk': '–ö–∏–±–µ—Ä–ø–∞–Ω–∫',
        'circuit2': '–ú–∏–∫—Ä–æ—Å—Ö–µ–º–∞ 2', 'glitch': '–ì–ª–∏—Ç—á', 'rain': '–î–æ–∂–¥—å',
        'fire': '–û–≥–æ–Ω—å', 'water': '–í–æ–¥–∞', 'wind': '–í–µ—Ç–µ—Ä',
        'vortex': '–í–æ—Ä–æ–Ω–∫–∞', 'spiral': '–°–ø–∏—Ä–∞–ª—å', 'radar': '–†–∞–¥–∞—Ä',
        'sonar': '–°–æ–Ω–∞—Ä'
    };
    
    return names[bg] || bg;
}

// –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∫–Ω–æ–ø–∫–∏
function createSocialButton(icon, text, url, className = '', color = '') {
    if (!url) return '';
    
    const style = color ? `style="background-color: ${color};"` : '';
    return `
        <a href="${url}" class="action-btn ${className}" ${style} target="_blank" rel="noopener noreferrer">
            <i class="${icon}"></i> ${text}
        </a>
    `;
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function updateMembersCounter() {
    const counter = document.getElementById('members-counter');
    if (!counter) return;
    
    const visibleCards = document.querySelectorAll('.member-card[style*="display: flex"]').length;
    const totalCards = document.querySelectorAll('.member-card').length;
    
    counter.textContent = `–ü–æ–∫–∞–∑–∞–Ω–æ: ${visibleCards} –∏–∑ ${totalCards}`;
}

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
function addPagination(totalItems) {
    const container = document.getElementById('members-container');
    if (!container) return;
    
    const totalPages = Math.ceil(totalItems / MEMBERS_PER_PAGE);
    
    const pagination = document.createElement('div');
    pagination.className = 'pagination';
    pagination.innerHTML = `
        <button class="pagination-btn prev ${currentPage === 1 ? 'disabled' : ''}" 
                onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>
            <i class="fas fa-chevron-left"></i>
        </button>
        
        <div class="pagination-pages">
            ${generatePageNumbers(currentPage, totalPages)}
        </div>
        
        <button class="pagination-btn next ${currentPage === totalPages ? 'disabled' : ''}" 
                onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>
            <i class="fas fa-chevron-right"></i>
        </button>
    `;
    
    container.appendChild(pagination);
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü
function generatePageNumbers(current, total) {
    let pages = '';
    
    if (total <= 7) {
        // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        for (let i = 1; i <= total; i++) {
            pages += `<button class="page-number ${i === current ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
        }
    } else {
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å —Ç–æ—á–∫–∞–º–∏
        if (current <= 4) {
            for (let i = 1; i <= 5; i++) {
                pages += `<button class="page-number ${i === current ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
            }
            pages += '<span class="page-dots">...</span>';
            pages += `<button class="page-number" onclick="changePage(${total})">${total}</button>`;
        } else if (current >= total - 3) {
            pages += `<button class="page-number" onclick="changePage(1)">1</button>`;
            pages += '<span class="page-dots">...</span>';
            for (let i = total - 4; i <= total; i++) {
                pages += `<button class="page-number ${i === current ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
            }
        } else {
            pages += `<button class="page-number" onclick="changePage(1)">1</button>`;
            pages += '<span class="page-dots">...</span>';
            for (let i = current - 1; i <= current + 1; i++) {
                pages += `<button class="page-number ${i === current ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
            }
            pages += '<span class="page-dots">...</span>';
            pages += `<button class="page-number" onclick="changePage(${total})">${total}</button>`;
        }
    }
    
    return pages;
}

// –°–º–µ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
function changePage(page) {
    if (page < 1 || page > Math.ceil(members.length / MEMBERS_PER_PAGE)) return;
    
    currentPage = page;
    loadMembers();
    playSound('page-change');
    
    // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–∞—á–∞–ª—É —Å–ø–∏—Å–∫–∞
    const container = document.getElementById('members-container');
    if (container) {
        container.scrollIntoView({ behavior: 'smooth' });
    }
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
function applySort(sortBy) {
    localStorage.setItem('fame_sort_by', sortBy);
    loadMembers();
}

// =============================================
// –£–ü–†–ê–í–õ–ï–ù–ò–ï –ó–í–£–ö–ê–ú–ò
// =============================================
const sounds = {
    'click': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'menu-open': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'menu-close': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'modal-open': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'modal-close': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'card-click': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'filter': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'clear': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'profile-open': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'snow-on': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'snow-off': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'tab-switch': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'theme-change': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'upload-success': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'upload-error': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'neon-on': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'neon-off': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'neon-apply': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'bg-apply': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'bg-select': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'copy-success': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'remove-bg': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA=='),
    'page-change': new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA==')
};

function playSound(soundName) {
    if (!localStorage.getItem('fame_sounds_enabled')) {
        localStorage.setItem('fame_sounds_enabled', 'true');
    }
    
    if (localStorage.getItem('fame_sounds_enabled') === 'true' && sounds[soundName]) {
        try {
            sounds[soundName].currentTime = 0;
            sounds[soundName].play().catch(e => console.log('üîá –ó–≤—É–∫ –æ—Ç–∫–ª—é—á–µ–Ω'));
        } catch (e) {
            console.log('üîá –û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞:', e);
        }
    }
}

// =============================================
// –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø
// =============================================
function showNotification(message, type = 'info') {
    // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
    let container = document.getElementById('notifications-container');
    if (!container) {
        container = document.createElement('div');
        container.id = 'notifications-container';
        container.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        `;
        document.body.appendChild(container);
    }
    
    // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.style.cssText = `
        background: ${type === 'success' ? 'rgba(0, 255, 0, 0.1)' : 
                     type === 'error' ? 'rgba(255, 0, 0, 0.1)' : 
                     type === 'warning' ? 'rgba(255, 215, 0, 0.1)' : 
                     'rgba(0, 204, 255, 0.1)'};
        border: 1px solid ${type === 'success' ? 'rgba(0, 255, 0, 0.3)' : 
                           type === 'error' ? 'rgba(255, 0, 0, 0.3)' : 
                           type === 'warning' ? 'rgba(255, 215, 0, 0.3)' : 
                           'rgba(0, 204, 255, 0.3)'};
        border-radius: 10px;
        padding: 15px 20px;
        min-width: 300px;
        max-width: 400px;
        backdrop-filter: blur(10px);
        transform: translateX(100px);
        opacity: 0;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 15px;
    `;
    
    const icon = type === 'success' ? '‚úÖ' :
                 type === 'error' ? '‚ùå' :
                 type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
    
    notification.innerHTML = `
        <span style="font-size: 20px;">${icon}</span>
        <div style="flex: 1;">
            <div style="font-weight: 600; margin-bottom: 5px; color: var(--text-color);">
                ${type === 'success' ? '–£—Å–ø–µ—à–Ω–æ' : 
                  type === 'error' ? '–û—à–∏–±–∫–∞' : 
                  type === 'warning' ? '–í–Ω–∏–º–∞–Ω–∏–µ' : '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'}
            </div>
            <div style="color: var(--text-secondary); font-size: 14px;">${message}</div>
        </div>
        <button onclick="this.parentElement.remove()" style="background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 18px;">
            √ó
        </button>
    `;
    
    container.appendChild(notification);
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
    setTimeout(() => {
        notification.style.transform = 'translateX(0)';
        notification.style.opacity = '1';
    }, 10);
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
    setTimeout(() => {
        if (notification.parentElement) {
            notification.style.transform = 'translateX(100px)';
            notification.style.opacity = '0';
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 300);
        }
    }, 5000);
}

// =============================================
// –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò
// =============================================
function initPerformanceOptimizations() {
    console.log('‚ö° –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏...');
    
    // –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    if ('IntersectionObserver' in window) {
        const lazyImages = document.querySelectorAll('img[loading="lazy"]');
        const imageObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    img.src = img.dataset.src || img.src;
                    img.classList.add('loaded');
                    observer.unobserve(img);
                }
            });
        });
        
        lazyImages.forEach(img => imageObserver.observe(img));
    }
    
    // –î–µ–±–∞—É–Ω—Å –¥–ª—è —Å–æ–±—ã—Ç–∏–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
    let scrollTimeout;
    window.addEventListener('scroll', () => {
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(() => {
            // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
            document.body.classList.add('scrolling-stopped');
        }, 100);
    });
    
    // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
    const criticalResources = [
        'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css',
        'style.css',
        'script.js'
    ];
    
    criticalResources.forEach(resource => {
        const link = document.createElement('link');
        link.rel = 'preload';
        link.href = resource;
        link.as = resource.endsWith('.css') ? 'style' : 'script';
        document.head.appendChild(link);
    });
    
    console.log('‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
}

// =============================================
// SERVICE WORKER –î–õ–Ø –û–§–§–õ–ê–ô–ù-–î–û–°–¢–£–ü–ê
// =============================================
function initServiceWorker() {
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('/sw.js').then(registration => {
                console.log('‚úÖ ServiceWorker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', registration.scope);
            }).catch(error => {
                console.log('‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ServiceWorker:', error);
            });
        });
    }
}

// =============================================
// –ü–†–û–í–ï–†–ö–ê –û–ë–ù–û–í–õ–ï–ù–ò–ô
// =============================================
function checkForUpdates() {
    const lastUpdate = localStorage.getItem('fame_last_update_check');
    const now = Date.now();
    
    // –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–µ —á–∞—â–µ —á–µ–º —Ä–∞–∑ –≤ –¥–µ–Ω—å
    if (!lastUpdate || now - lastUpdate > 24 * 60 * 60 * 1000) {
        fetch('/version.json')
            .then(response => response.json())
            .then(data => {
                const currentVersion = localStorage.getItem('fame_version') || '1.0.0';
                if (data.version !== currentVersion) {
                    showNotification(`–î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ –≤–µ—Ä—Å–∏–∏ ${data.version}`, 'info');
                    localStorage.setItem('fame_version', data.version);
                }
                localStorage.setItem('fame_last_update_check', now.toString());
            })
            .catch(() => {
                // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
            });
    }
}

// =============================================
// –¢–†–ï–ö–ò–ù–ì –ü–†–û–°–ú–û–¢–†–û–í –ü–†–û–§–ò–õ–ï–ô
// =============================================
function trackProfileView(memberId) {
    const views = JSON.parse(localStorage.getItem('fame_profile_views') || '{}');
    views[memberId] = (views[memberId] || 0) + 1;
    localStorage.setItem('fame_profile_views', JSON.stringify(views));
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
    const viewCount = document.querySelector('.profile-view-count');
    if (viewCount) {
        viewCount.textContent = `–ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤: ${views[memberId]}`;
    }
}

// =============================================
// –ü–†–ò–í–ï–¢–°–¢–í–ï–ù–ù–û–ï –°–û–û–ë–©–ï–ù–ò–ï
// =============================================
function showWelcomeMessage() {
    if (!localStorage.getItem('fame_welcome_shown')) {
        showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ NoolShy Fame!', 'info');
        localStorage.setItem('fame_welcome_shown', 'true');
    }
}

// =============================================
// –ù–ê–°–¢–†–û–ô–ö–ê –û–ë–†–ê–ë–û–¢–ß–ò–ö–û–í –°–û–ë–´–¢–ò–ô
// =============================================
function setupEventListeners() {
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
    document.getElementById('snow-effect')?.addEventListener('change', function() {
        localStorage.setItem('fame_snow', this.checked ? 'enabled' : 'disabled');
    });
    
    document.getElementById('neon-flow-effect')?.addEventListener('change', function() {
        localStorage.setItem('fame_neon_flow', this.checked ? 'enabled' : 'disabled');
        if (this.checked) {
            initDynamicNeon();
        } else {
            removeNeonFlow();
        }
    });
    
    // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–µ–∫—Ü–∏–π
    window.switchSection = function(sectionId) {
        console.log('üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–∏:', sectionId);
        
        document.querySelectorAll('.section').forEach(section => {
            section.classList.remove('active-section');
        });
        
        const targetSection = document.getElementById(sectionId);
        if (targetSection) {
            targetSection.classList.add('active-section');
        }
        
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.classList.remove('active');
            if (tab.dataset.section === sectionId) {
                tab.classList.add('active');
            }
        });
    };
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏—à –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    document.addEventListener('keydown', (e) => {
        // Ctrl + F –¥–ª—è –ø–æ–∏—Å–∫–∞
        if (e.ctrlKey && e.key === 'f') {
            e.preventDefault();
            const searchInput = document.getElementById('search-input');
            if (searchInput) {
                searchInput.focus();
            }
        }
        
        // Escape –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        if (e.key === 'Escape') {
            closeAllModals();
        }
        
        // –°—Ç—Ä–µ–ª–∫–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –º–µ–∂–¥—É —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
        if (document.getElementById('profile-details').classList.contains('active-section')) {
            if (e.key === 'ArrowLeft') {
                navigateProfile(-1);
            } else if (e.key === 'ArrowRight') {
                navigateProfile(1);
            }
        }
    });
    
    console.log('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã');
}

// =============================================
// –ù–ê–í–ò–ì–ê–¶–ò–Ø –ú–ï–ñ–î–£ –ü–†–û–§–ò–õ–Ø–ú–ò
// =============================================
function navigateProfile(direction) {
    const currentProfile = document.querySelector('.profile-header .profile-title')?.textContent;
    if (!currentProfile) return;
    
    const currentIndex = members.findIndex(m => m.nickname === currentProfile);
    if (currentIndex === -1) return;
    
    let newIndex = currentIndex + direction;
    if (newIndex < 0) newIndex = members.length - 1;
    if (newIndex >= members.length) newIndex = 0;
    
    showProfile(members[newIndex].id);
    playSound('card-click');
}

// =============================================
// –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–ï–†–ï–ú–ï–ù–ù–´–• –¢–ï–ú–´
// =============================================
function updateThemeVariables(theme) {
    const root = document.documentElement;
    
    const themeColors = {
        'dark': { primary: '#ff0080', secondary: '#00ffcc', bg: '#0f0f0f' },
        'black': { primary: '#ffffff', secondary: '#808080', bg: '#000000' },
        'red': { primary: '#ff0000', secondary: '#ff6666', bg: '#200000' },
        'red-black': { primary: '#ff0000', secondary: '#8b0000', bg: '#000000' },
        'red-gray': { primary: '#ff0000', secondary: '#808080', bg: '#2a2a2a' },
        'purple': { primary: '#9d00ff', secondary: '#d4a6ff', bg: '#1a0033' },
        'blue': { primary: '#0074d9', secondary: '#7fdbff', bg: '#001f3f' },
        'green': { primary: '#00ff00', secondary: '#66ff66', bg: '#003300' },
        'orange': { primary: '#ff9900', secondary: '#ffcc66', bg: '#331a00' },
        'pink': { primary: '#ff66cc', secondary: '#ff99dd', bg: '#330033' }
    };
    
    const colors = themeColors[theme] || themeColors.dark;
    
    root.style.setProperty('--primary-color', colors.primary);
    root.style.setProperty('--secondary-color', colors.secondary);
    root.style.setProperty('--dark-bg', colors.bg);
}

// =============================================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
// =============================================
// –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
        if (!isInitialized) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active-section');
            });
            document.getElementById('main')?.classList.add('active-section');
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π
            updateThemeVariables(currentTheme);
            applyAnimatedBg();
            if (neonFlowEnabled) initDynamicNeon();
        }
    });
}

// –≠–∫—Å–ø–æ—Ä—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
window.members = members;
window.currentTheme = currentTheme;
window.currentNeonColor = currentNeonColor;
window.currentNeonIntensity = currentNeonIntensity;
window.currentNeonSpeed = currentNeonSpeed;

console.log('üöÄ NoolShy Fame –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');

// =============================================
// –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–°–®–ò–†–ï–ù–ò–Ø
// =============================================

// –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function exportMembersData() {
    const data = {
        version: '1.0.0',
        exportDate: new Date().toISOString(),
        members: members.map(m => ({
            id: m.id,
            nickname: m.nickname,
            category: m.category,
            role: m.role,
            description: m.description,
            verified: m.verified,
            pinned: m.pinned,
            followers: m.followers,
            posts: m.posts
        }))
    };
    
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `noolshy-fame-export-${new Date().toISOString().split('T')[0]}.json`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    
    showNotification('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
}

// –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function importMembersData(file) {
    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const data = JSON.parse(e.target.result);
            if (data.members && Array.isArray(data.members)) {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –ª–æ–≥–∏–∫–∞ –∏–º–ø–æ—Ä—Ç–∞
                showNotification('–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–µ–Ω', 'success');
                console.log('–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤:', data.members.length);
            } else {
                throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö');
            }
        } catch (error) {
            showNotification('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: ' + error.message, 'error');
        }
    };
    reader.readAsText(file);
}

// –°–±—Ä–æ—Å –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
function resetAllSettings() {
    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏?')) {
        localStorage.clear();
        location.reload();
    }
}

// –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
function createBackup() {
    const backup = {
        settings: {
            theme: localStorage.getItem('fame_theme'),
            neonColor: localStorage.getItem('fame_neon_color'),
            neonIntensity: localStorage.getItem('fame_neon_intensity'),
            neonSpeed: localStorage.getItem('fame_neon_speed'),
            animatedBg: localStorage.getItem('fame_animated_bg'),
            bgSpeed: localStorage.getItem('fame_bg_speed'),
            bgOpacity: localStorage.getItem('fame_bg_opacity'),
            snow: localStorage.getItem('fame_snow'),
            neonFlow: localStorage.getItem('fame_neon_flow')
        },
        profileViews: JSON.parse(localStorage.getItem('fame_profile_views') || '{}'),
        timestamp: new Date().toISOString()
    };
    
    const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `noolshy-fame-backup-${new Date().toISOString().split('T')[0]}.json`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    
    showNotification('–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–Ω–∞', 'success');
}

// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
function restoreFromBackup(file) {
    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const backup = JSON.parse(e.target.result);
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            if (backup.settings) {
                Object.entries(backup.settings).forEach(([key, value]) => {
                    if (value !== null) {
                        localStorage.setItem(`fame_${key}`, value);
                    }
                });
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –ø—Ä–æ—Ñ–∏–ª–µ–π
            if (backup.profileViews) {
                localStorage.setItem('fame_profile_views', JSON.stringify(backup.profileViews));
            }
            
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã', 'success');
            setTimeout(() => location.reload(), 1000);
            
        } catch (error) {
            showNotification('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è: ' + error.message, 'error');
        }
    };
    reader.readAsText(file);
}

// –≠–∫—Å–ø–æ—Ä—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
window.exportMembersData = exportMembersData;
window.importMembersData = importMembersData;
window.resetAllSettings = resetAllSettings;
window.createBackup = createBackup;
window.restoreFromBackup = restoreFromBackup;
window.navigateProfile = navigateProfile;

// =============================================
// –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –û–ë–ù–û–í–õ–ï–ù–ò–Ø
// =============================================
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
setInterval(checkForUpdates, 30 * 60 * 1000);

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
window.addEventListener('beforeunload', () => {
    localStorage.setItem('fame_last_session', Date.now().toString());
});

// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
const lastSession = localStorage.getItem('fame_last_session');
if (lastSession && Date.now() - parseInt(lastSession) < 5 * 60 * 1000) {
    // –ú–µ–Ω–µ–µ 5 –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥ - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ—Å—Å–∏—é
    console.log('üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å–µ—Å—Å–∏–∏...');
}

console.log('üéâ NoolShy Fame –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');
